## ğŸ› ï¸ DEMO: Launch Bastion Host vÃ o Public Subnet + Clean-up VPC (Step-by-step cá»±c chi tiáº¿t)

---

## ğŸ¯ Má»¥c tiÃªu
- Thá»±c hÃ nh launch **EC2 Bastion Host** vÃ o web subnet Ä‘Ã£ public.
- Test káº¿t ná»‘i tá»« ngoÃ i Internet vÃ o VPC qua Bastion.
- HÆ°á»›ng dáº«n **dá»n sáº¡ch (clean-up)** infrastructure vá» tráº¡ng thÃ¡i ban Ä‘áº§u (khÃ´ng máº¥t phÃ­).

---

## Pháº§n 1: Launch EC2 Bastion Host vÃ o Web Subnet

### 1.1. **VÃ o EC2 Console**
- AWS Console â†’ Services â†’ EC2

### 1.2. **Launch Instance**
- Click `Launch instance`
- **Name:** `A4L-Bastion`
- **AMI:** Chá»n `Amazon Linux` (latest, Free Tier Eligible)
- **Architecture:** 64-bit (x86)
- **Instance type:** `t2.micro` hoáº·c `t3.micro` (Free Tier eligible)

### 1.3. **Key Pair**
- **Chá»n:** Key pair cÃ³ tÃªn `A4L` (náº¿u Ä‘Ã£ táº¡o)
- Náº¿u chÆ°a cÃ³, click `Create new key pair`:
    - Name: `A4L`
    - Type: RSA
    - Format: `.pem`
    - Download file nÃ y vá» mÃ¡y (ráº¥t quan trá»ng!)

### 1.4. **Network settings**
- **VPC:** Chá»n `A4L-VPC1`
- **Subnet:** Chá»n `SN-EN-web-A` (hoáº·c tÃªn subnet web-A cá»§a báº¡n)
- **Auto-assign public IP:** Enabled
- **Auto-assign IPv6 IP:** Enabled (náº¿u cÃ³)

### 1.5. **Security Group**
- Chá»n `Create security group`
    - **Name:** `A4L-bastion-SG`
    - **Description:** `A4L bastion SG`
    - **Rule:** SSH (port 22)  
        - Source: `0.0.0.0/0` vÃ  `::/0` (cháº¥p nháº­n tá»« má»i IP â€“ chá»‰ dÃ¹ng khi há»c, production cáº§n giá»›i háº¡n IP)
- **CÃ¡c setting cÃ²n láº¡i:** Giá»¯ máº·c Ä‘á»‹nh

### 1.6. **Launch!**
- Click `Launch instance`
- VÃ o `Instances` â†’ kiá»ƒm tra instance Ä‘ang khá»Ÿi táº¡o (`initializing`).  
  Äá»£i tráº¡ng thÃ¡i chuyá»ƒn sang `2/2 status checks`.

---

## Pháº§n 2: Káº¿t ná»‘i SSH vÃ o Bastion Host

### 2.1. **Kiá»ƒm tra thÃ´ng tin**
- Chá»n instance vá»«a launch
- Láº¥y **Public IPv4 address** (dÃ¹ng Ä‘á»ƒ SSH)
- Láº¥y **Private IPv4 address** (dÃ¹ng cho kiá»ƒm tra ná»™i bá»™)

### 2.2. **Káº¿t ná»‘i SSH** (TÃ¹y chá»n 1: EC2 Instance Connect)
- Chá»n instance â†’ `Connect` â†’ `EC2 Instance Connect`
- **Username:** `ec2-user`
- Click `Connect` (sáº½ má»Ÿ web SSH terminal)

### 2.3. **Káº¿t ná»‘i SSH** (TÃ¹y chá»n 2: Local SSH Client)
- Äáº£m báº£o file key pair `.pem` trong thÆ° má»¥c (VD: `~/Downloads`)
- **Lá»‡nh SSH máº«u:**
    ```bash
    chmod 400 A4L.pem  # Sá»­a permission cho key (Linux/Mac)
    ssh -i A4L.pem ec2-user@<Public-IP-v4-address>
    ```
- Náº¿u láº§n Ä‘áº§u, nháº­p `yes` khi Ä‘Æ°á»£c há»i xÃ¡c nháº­n fingerprint.

> **Tip:** Náº¿u lá»—i â€œWARNING: UNPROTECTED PRIVATE KEY FILE!â€, dÃ¹ng `chmod 400` sá»­a láº¡i quyá»n file key.

---

## Pháº§n 3: Clean-up (XÃ³a Bastion Host vÃ  toÃ n bá»™ VPC khi khÃ´ng dÃ¹ng ná»¯a)

### 3.1. **XÃ³a Bastion Host**
- EC2 Console â†’ Chá»n `A4L-Bastion`
- Right click â†’ `Instance State` â†’ `Terminate instance`
- Confirm â†’ Äá»£i tráº¡ng thÃ¡i thÃ nh `terminated`

### 3.2. **XÃ³a toÃ n bá»™ VPC (vÃ  cÃ¡c tÃ i nguyÃªn liÃªn quan)**
- VPC Console â†’ `Your VPCs` â†’ Chá»n `A4L-VPC1`
- Actions â†’ `Delete VPC`
- GÃµ `delete` Ä‘á»ƒ xÃ¡c nháº­n â†’ Click `Delete`

> **Khi xÃ³a VPC**: AWS tá»± Ä‘á»™ng xÃ³a luÃ´n IGW, subnet, route tableâ€¦ liÃªn quan, cá»±c nhanh vÃ  sáº¡ch.

---

## ğŸ“š Kinh nghiá»‡m thá»±c táº¿ & ghi nhá»› khi Ä‘i lÃ m/thi

- Bastion host chá»‰ nÃªn dÃ¹ng cho lab hoáº·c táº¡m thá»i â€“ production nÃªn dÃ¹ng SSM Session Manager, EC2 Instance Connect.
- Sau má»—i bÃ i thá»±c hÃ nh, **nÃªn xÃ³a (clean-up)** Ä‘á»ƒ trÃ¡nh phÃ¡t sinh phÃ­ vÃ´ Ã½!
- Khi gáº·p lá»—i SSH: kiá»ƒm tra Ä‘Ãºng public IP, Ä‘Ãºng username (`ec2-user`), Ä‘Ãºng permission file key.

---

## âœ… TÃ³m táº¯t cÃ¡c bÆ°á»›c Ä‘Ã£ thá»±c hiá»‡n
1. Launch EC2 Bastion Host vÃ o public subnet
2. Káº¿t ná»‘i SSH tá»« Internet vÃ o instance
3. Thá»±c hÃ nh dá»n sáº¡ch (terminate + delete VPC)

---

**Sau bÃ i nÃ y, báº¡n Ä‘Ã£ thá»±c sá»± lÃ m chá»§ quy trÃ¬nh táº¡o public subnet, kiá»ƒm tra káº¿t ná»‘i, clean-up AWS lab cá»±c ká»³ bÃ i báº£n. Chuáº©n bá»‹ cho cÃ¡c bÃ i networking nÃ¢ng cao tiáº¿p theo! ğŸš€**
