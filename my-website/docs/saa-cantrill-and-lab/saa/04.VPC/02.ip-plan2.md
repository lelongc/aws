## ğŸ¯ VPC Sizing & IP Plan: TÆ° duy cá»§a Kiáº¿n trÃºc sÆ° Cloud 

---
<img width="831" height="469" alt="image" src="https://github.com/user-attachments/assets/e3bd5d53-352e-4ac9-9eaf-08540b7d62e6" />

## PHáº¦N 1: LÃ½ thuyáº¿t ná»n táº£ng (Pháº£i nhá»›)

### 1. **Táº¡i sao pháº£i lÃªn káº¿ hoáº¡ch cho VPC & Subnet?**
- **VPC** lÃ  â€œmáº£nh Ä‘áº¥tâ€ cá»§a báº¡n trÃªn AWS (má»—i VPC lÃ  1 khu Ä‘áº¥t riÃªng, chá»n kÃ­ch thÆ°á»›c vÃ  chia phÃ²ng sao cho há»£p lÃ½).
- Náº¿u chá»n sai tá»« Ä‘áº§u (IP chá»“ng láº¥n, subnet quÃ¡ nhá»/khÃ´ng Ä‘á»§ dÃ¹ng), sau nÃ y má»Ÿ rá»™ng, káº¿t ná»‘i, hoáº·c migrate sáº½ cá»±c ká»³ Ä‘au Ä‘áº§u vÃ  tá»‘n tiá»n!

### 2. **CÃ¡c khÃ¡i niá»‡m cÆ¡ báº£n**
- **CIDR Block**: Dáº£i IP cá»§a VPC/subnet. VD: `10.16.0.0/16` (65,536 IPs), `10.16.0.0/20` (4,096 IPs).
- **Subnet**: Má»—i subnet lÃ  má»™t â€œphÃ²ngâ€ trong â€œngÃ´i nhÃ â€ VPC, gÃ¡n vÃ o 1 AZ duy nháº¥t.

### 3. **CÃ¡c máº«u VPC sizing thÆ°á»ng gáº·p (theo AWS)**
| Loáº¡i VPC      | CIDR VPC     | Sá»‘ Subnet | CIDR má»—i Subnet | Sá»‘ IP/subnet | Tá»•ng IP usable |
|---------------|--------------|-----------|-----------------|--------------|---------------|
| Micro         | /24          | 8         | /27             | 27           | 216           |
| Small         | /22          | 8         | /25             | 123          | 984           |
| Medium        | /20          | 8         | /27             | 27           | 216           |
| Large         | /16          | 16        | /20             | 4,091        | 65,456        |

> **Ghi nhá»›:** Má»—i láº§n tÄƒng sá»‘ á»Ÿ sau dáº¥u â€œ/â€ lÃªn 1 thÃ¬ sá»‘ máº¡ng con gáº¥p Ä‘Ã´i, sá»‘ IP má»—i máº¡ng con giáº£m má»™t ná»­a.

### 4. **NguyÃªn táº¯c chuáº©n khi chia subnet**
- **Má»—i AZ â†’ Ã­t nháº¥t 1 subnet cho má»—i tier (web/app/db/â€œbufferâ€)**
- **LuÃ´n dÃ nh â€œspare/bufferâ€ subnet cho má»Ÿ rá»™ng**
- **CÃ¡c subnet pháº£i náº±m trá»n trong VPC, khÃ´ng trÃ¹ng nhau**
- **Chá»n dÆ° IP hÆ¡n nhu cáº§u hiá»‡n táº¡i (dá»± phÃ²ng má»Ÿ rá»™ng)**

---

## PHáº¦N 2: Thá»±c táº¿ cÃ´ng viá»‡c (CÃ¡ch chuyÃªn gia lÃ m ngoÃ i Ä‘á»i)

### 1. **Quy trÃ¬nh chuáº©n Ä‘á»ƒ thiáº¿t káº¿ VPC IP plan**

**BÆ°á»›c 1: XÃ¡c Ä‘á»‹nh sá»‘ lÆ°á»£ng AZ sáº½ dÃ¹ng**
- Háº§u háº¿t region cÃ³ 3 AZ, chá»n **3 AZ + 1 buffer** (tá»•ng 4 AZ) Ä‘á»ƒ má»Ÿ rá»™ng dá»….
- TÃªn AZ: a, b, c, (d hoáº·c spare)

**BÆ°á»›c 2: XÃ¡c Ä‘á»‹nh sá»‘ tiers (lá»›p) cá»§a há»‡ thá»‘ng**
- ThÆ°á»ng cÃ³ 3 tier: Web, App, Database + 1 buffer (tá»•ng 4 tier)

**BÆ°á»›c 3: Sá»‘ subnet cáº§n thiáº¿t = Sá»‘ AZ x Sá»‘ tier = 4 x 4 = 16 subnet**

**BÆ°á»›c 4: Chá»n dáº£i IP cho VPC (thÆ°á»ng /16)**
- VD: `10.16.0.0/16` cho má»—i VPC (65,536 IP usable)
- Chia ra 16 subnet, má»—i subnet lÃ  `/20` (má»—i subnet ~4,091 IP usable)

**BÆ°á»›c 5: Láº­p báº£ng phÃ¢n bá»• IP**
- Táº¡o file excel/pdf lÆ°u láº¡i tá»«ng dáº£i IP cho tá»«ng region, tá»«ng account Ä‘á»ƒ khÃ´ng trÃ¹ng láº·p.
- VÃ­ dá»¥:
  
  | Region    | Account  | VPC CIDR        | Subnet AZa      | Subnet AZb      | ... |
  |-----------|----------|-----------------|-----------------|-----------------|-----|
  | us-east-1 | general  | 10.16.0.0/16    | 10.16.0.0/20    | 10.16.16.0/20   | ... |
  | us-east-1 | prod     | 10.17.0.0/16    | 10.17.0.0/20    | 10.17.16.0/20   | ... |
  | eu-west-1 | dev      | 10.64.0.0/16    | 10.64.0.0/20    | 10.64.16.0/20   | ... |
  
- **Tip:** TrÃ¡nh dÃ¹ng cÃ¡c dáº£i 10.0.0.0/8, 10.1.0.0/16â€¦ (Google/GCP thÆ°á»ng dÃ¹ng), trÃ¡nh luÃ´n 192.168.x.x trÃ¹ng máº¡ng ná»™i bá»™ cÃ´ng ty.

### 2. **TÆ° duy thiáº¿t káº¿ subnet thá»±c táº¿**
- **LÃºc phÃ¡t triá»ƒn cÃ³ thá»ƒ chá»‰ dÃ¹ng 1-2 AZ, nhÆ°ng luÃ´n nÃªn chia 4 AZ/subnet ngay tá»« Ä‘áº§u** (trÃ¡nh thiáº¿u sau nÃ y).
- **Web/App tier Ä‘á»ƒ á»Ÿ public/private subnet tÃ¹y nhu cáº§u, DB tier nÃªn luÃ´n á»Ÿ private subnet.**
- **KhÃ´ng Ä‘á»ƒ má»i thá»© á»Ÿ public subnet nhÆ° Default VPC!**

### 3. **BÃ i há»c tá»« thá»±c táº¿**
- Náº¿u khÃ´ng lÃªn plan ngay tá»« Ä‘áº§u, khi cáº§n káº¿t ná»‘i hybrid (VPN, Direct Connect, VPC Peering) sáº½ bá»‹ trÃ¹ng IP, pháº£i migrate cá»±c ká»³ tá»‘n kÃ©m.
- Má»™t sá»‘ cÃ´ng ty lá»›n pháº£i thuÃª ngoÃ i dá»‹ch vá»¥ audit láº¡i toÃ n bá»™ VPC/subnet/IP, máº¥t hÃ ng tuáº§n chá»‰ vÃ¬ khÃ´ng cÃ³ IP plan.
- **LuÃ´n lÆ°u láº¡i báº£ng IP plan, share cho team Ä‘á»ƒ trÃ¡nh conflict!**

---

## PHáº¦N 3: TÆ° duy thá»±c chiáº¿n & bÃ i táº­p Ã¡p dá»¥ng

### 1. **Checklist khi design VPC**
- [ ] ÄÃ£ chá»n Ä‘á»§ AZ (tá»‘i thiá»ƒu 3, tá»‘t nháº¥t 4)
- [ ] ÄÃ£ dá»± phÃ²ng sá»‘ tier/subnet cho tÆ°Æ¡ng lai
- [ ] ÄÃ£ chá»n dáº£i IP khÃ´ng trÃ¹ng vá»›i cÃ¡c há»‡ thá»‘ng khÃ¡c
- [ ] ÄÃ£ chia subnet Ä‘á»§ rá»™ng, dÆ° so vá»›i nhu cáº§u hiá»‡n táº¡i
- [ ] CÃ³ file lÆ°u láº¡i toÃ n bá»™ IP plan

### 2. **CÃ¡c cÃ¢u há»i phá»ng váº¥n/cert hay gáº·p**
- â€œVÃ¬ sao nÃªn trÃ¡nh dÃ¹ng 10.0.0.0/16 cho VPC?â€
- â€œNáº¿u thiáº¿t káº¿ VPC cho 4 AZ vÃ  4 tier, cáº§n bao nhiÃªu subnet? Má»—i subnet nÃªn lÃ  CIDR gÃ¬?â€
- â€œLÃ m tháº¿ nÃ o Ä‘á»ƒ trÃ¡nh trÃ¹ng IP khi cÃ³ nhiá»u VPC/account/region?â€
- â€œDefault VPC khÃ¡c gÃ¬ Custom VPC vá» máº·t subnetting vÃ  IP planning?â€

### 3. **BÃ i táº­p hands-on**
- Tá»± láº­p plan IP cho 2 region (us-east-1, ap-southeast-1), má»—i region cÃ³ 2 account (prod/dev). Má»—i account 1 VPC /16, chia thÃ nh 16 subnet /20.
- Váº½ sÆ¡ Ä‘á»“/mindmap phÃ¢n bá»• subnet cho má»—i AZ, má»—i tier.
- Thá»±c hÃ nh táº¡o VPC vÃ  subnet thá»§ cÃ´ng trÃªn AWS Console hoáº·c dÃ¹ng Terraform.

---

## PHáº¦N 4: Tips nhá»› lÃ¢u & tá»•ng káº¿t

- **Rule of 4:** 4 AZ x 4 tier = 16 subnet (ráº¥t chuáº©n Ä‘á»ƒ Ä‘i thi vÃ  Ä‘i lÃ m)
- **/16 â†’ chia 16 subnet = /20 má»—i subnet**  
- **File IP plan lÃ  â€œbáº£o bá»‘iâ€ khi Ä‘i lÃ m, Ä‘i audit, Ä‘i thi**
- **LÃºc nÃ o cÅ©ng dÆ° subnet & IP, khÃ´ng bao giá» chia sÃ¡t nÃºt!**
- **TrÃ¡nh IP phá»• biáº¿n, trÃ¡nh trÃ¹ng GCP/Azure/vÄƒn phÃ²ng**

---

### ğŸ“Œ Káº¿t luáº­n  
- LÃªn IP plan VPC/subnet lÃ  ká»¹ nÄƒng â€œcoreâ€ cá»§a architect/cloud eng, pháº£i lÃ m tháº­t cháº¯c, khÃ´ng Ä‘Æ°á»£c áº©u.
- Äá»c láº¡i bÃ i nÃ y má»—i láº§n chuáº©n bá»‹ setup mÃ´i trÆ°á»ng má»›i hoáº·c Ä‘i phá»ng váº¥n, Ä‘i thi!
- CÃ³ thá»ƒ dÃ¹ng â€œAnimals for Lifeâ€ IP plan hoáº·c tá»± táº¡o file riÃªng cho cÃ´ng ty/dá»± Ã¡n cá»§a mÃ¬nh.

