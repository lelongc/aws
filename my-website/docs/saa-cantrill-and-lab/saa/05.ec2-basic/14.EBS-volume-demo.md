## ğŸ› ï¸ Demo thá»±c táº¿: LÃ m viá»‡c vá»›i EBS & Instance Store TrÃªn EC2 (script Ä‘áº§y Ä‘á»§ Ä‘i lÃ m & Ä‘i thi)

---

## 1. Bá»‘i cáº£nh & lÆ°u Ã½ chi phÃ­

- **Pháº§n 1:** Demo EBS & snapshot (trong Free Tier)
- **Pháº§n 2:** Demo Instance Store (cÃ³ thá»ƒ máº¥t phÃ­, ~0.13$/giá» cho instance lá»›n, khÃ´ng Free Tier)

---

## 2. Chuáº©n bá»‹ mÃ´i trÆ°á»ng

- ÄÄƒng nháº­p AWS management account, chá»n region **N. Virginia (us-east-1)**
- DÃ¹ng CloudFormation template Ä‘á»ƒ táº¡o sáºµn **3 EC2 instances** (2 á»Ÿ AZ A, 1 á»Ÿ AZ B)
- Má»Ÿ EC2 Console > Instances, kiá»ƒm tra cÃ³ 3 instance: instance-1a, instance-2a, instance-1ab

---

## 3. Kiá»ƒm tra EBS volumes

- EC2 Console > Elastic Block Store > Volumes
- CÃ³ 3 volume 8 GiB, má»—i cÃ¡i gáº¯n vá»›i 1 instance lÃ m boot volume

---

## 4. Táº¡o EBS volume má»›i

- **Create Volume**
  - Volume type: **gp3**
  - Size: **10 GiB**
  - AZ: **us-east-1a**
  - Tag: key = `Name`, value = `EBS test volume`
- Báº¥m **Create volume**, chá» tráº¡ng thÃ¡i â€œavailableâ€

---

## 5. Attach volume vÃ o EC2

- Chá»n volume vá»«a táº¡o > Actions > Attach volume
- Chá»n instance **instance-1a** (chá»‰ tháº¥y instance cÃ¹ng AZ)
- Device: `/dev/sdf` (Linux cÃ³ thá»ƒ nháº­n lÃ  `/dev/xvdf`)
- Báº¥m **Attach**

---

## 6. SSH/Connect vÃ o EC2 instance

- EC2 Console > Instances > Chá»n **instance-1a** > Connect > EC2 Instance Connect
- User: `ec2-user`

---

## 7. Thao tÃ¡c trÃªn Linux (copy, paste tá»«ng dÃ²ng)

```bash
# Xem block devices
lsblk

# Kiá»ƒm tra file system (vd: trÃªn xvdf)
sudo file -s /dev/xvdf
# Náº¿u tráº£ vá» "data", chÆ°a cÃ³ file system

# Táº¡o file system (XFS)
sudo mkfs -t xfs /dev/xvdf

# Kiá»ƒm tra láº¡i file system
sudo file -s /dev/xvdf

# Táº¡o mount point
sudo mkdir /EBS-test

# Mount volume vÃ o thÆ° má»¥c
sudo mount /dev/xvdf /EBS-test

# Kiá»ƒm tra mount
df -h

# Chuyá»ƒn vÃ o thÆ° má»¥c mount
cd /EBS-test

# Táº¡o file test
sudo nano amazing-test-file.txt
# (Nháº­p ná»™i dung, Ctrl+O Ä‘á»ƒ lÆ°u, Ctrl+X Ä‘á»ƒ thoÃ¡t)

# Hiá»ƒn thá»‹ ná»™i dung file
cat amazing-test-file.txt

# Liá»‡t kÃª file
ls -l

# Reboot instance Ä‘á»ƒ test persistence
sudo reboot
# (Äá»£i vÃ i phÃºt, sau Ä‘Ã³ connect láº¡i instance)
```

---

## 8. Kiá»ƒm tra láº¡i sau reboot

- SSH láº¡i instance, cháº¡y:
```bash
lsblk
sudo mount /dev/xvdf /EBS-test
ls /EBS-test
cat /EBS-test/amazing-test-file.txt
```
- File váº«n cÃ²n, chá»©ng minh **EBS lÃ  persistent storage**

---

## 9. Kiáº¿n thá»©c bá»• sung & máº¹o Ä‘i thi

- **Chá»‰ attach EBS volume vÃ o instance cÃ¹ng AZ**
- **EBS volume tÃ¡ch rá»i vÃ²ng Ä‘á»i EC2:** Dá»«ng/xÃ³a instance, volume váº«n cÃ²n (trá»« khi chá»n delete on termination)
- **EBS volume dÃ¹ng Ä‘Æ°á»£c cho nhiá»u EC2 (sequential attach, khÃ´ng parallel)**
- **Instance Store:** Chá»‰ add khi launch, máº¥t data khi stop/start/terminate, chá»‰ dÃ¹ng cho temp/cache
- **Boot volume chá»‰ dÃ¹ng EBS, khÃ´ng dÃ¹ng instance store**
- **EBS volume cÃ³ thá»ƒ táº¡o tá»« snapshot, restore/migrate/clone sang AZ/region khÃ¡c**

---

## 10. Lá»‡nh tham kháº£o khÃ¡c

```bash
# Format ext4 thay cho xfs
sudo mkfs.ext4 /dev/xvdf

# Unmount volume
sudo umount /EBS-test

# XÃ³a volume khá»i EC2 (detach)
# AWS Console > Volumes > Actions > Detach
```

---

## 11. LÆ°u Ã½ chi phÃ­

- **EBS gp3:** ~$0.08/GB/thÃ¡ng (10GB ~ $0.8/thÃ¡ng)
- **Instance store:** KhÃ´ng tÃ­nh riÃªng, Ä‘Ã£ include trong giÃ¡ EC2
- **Part 2 (instance store):** DÃ¹ng instance lá»›n tá»‘n ~0.13$/giá»
- **Snapshot:** ~$0.05/GB/thÃ¡ng trÃªn data thá»±c dÃ¹ng

---

**TÃ³m táº¯t:**
- EBS: Persistent, attach/detach linh hoáº¡t, backup Ä‘Æ°á»£c (snapshot), chá»‰ attach cÃ¹ng AZ.
- Instance store: Hiá»‡u nÄƒng cao, ephemeral, chá»‰ add lÃºc launch, máº¥t data khi stop/start, khÃ´ng backup.
- Thá»±c hÃ nh Ä‘á»§ quy trÃ¬nh: táº¡o, attach, mount, test persistence, reboot, detach, xÃ³a...

---
