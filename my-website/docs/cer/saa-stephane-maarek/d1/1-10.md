# 1.**Amazon S3 Lifecycle** – cách mà bạn tự động **xóa hoặc lưu trữ dữ liệu cũ** trong S3 bucket. Mình sẽ **giải thích từng phần** một cách dễ hiểu nhất:

---

### 🔸 Bản gốc:

> **If you have an object expiration lifecycle configuration in your unversioned bucket**
>
> and **you want to maintain the same permanent delete behavior** when you enable versioning,
>
> you must add a **noncurrent expiration configuration** .

#### ✅ Nghĩa:

> Nếu bạn đang dùng cấu hình **tự động xóa đối tượng (object expiration)** trong một bucket **không bật versioning** ,
>
> và bạn muốn giữ nguyên hành vi "xóa vĩnh viễn" đó khi bạn **bật versioning lên** ,
>
> thì bạn **phải thêm một cấu hình `noncurrent expiration`** .

---

### 🔸 Bản gốc:

> The **noncurrent expiration lifecycle configuration** manages the **deletes of the noncurrent object versions**
>
> in the versioning-enabled bucket.

#### ✅ Nghĩa:

> Cấu hình `noncurrent expiration` dùng để **tự động xóa các phiên bản cũ (noncurrent versions)**
>
> trong bucket đã bật versioning.

---

### 🔸 Bản gốc:

> (A versioning-enabled bucket maintains one current, and zero or more noncurrent, object versions.)

#### ✅ Nghĩa:

> Một bucket bật versioning sẽ lưu:
>
> - 1 phiên bản hiện tại ( **current** )
> - và 0 hoặc nhiều phiên bản cũ ( **noncurrent** )

---

### 📌 Tóm tắt dễ hiểu:

| Trước khi bật versioning                     | Sau khi bật versioning                                   |
| -------------------------------------------- | -------------------------------------------------------- |
| Bạn dùng `expiration`để xóa object vĩnh viễn | S3 không còn xóa vĩnh viễn khi object bị ghi đè hoặc xóa |
| → Object biến mất hoàn toàn                  | → Object cũ trở thành**noncurrent version**              |
| Không cần thêm gì                            | **Phải thêm `noncurrent expiration`**để dọn rác          |

---

### 🔁 Ví dụ:

Bạn có file `report.pdf` trong bucket:

- ✅ Khi bucket **chưa bật versioning** :
  - Bạn cấu hình: "xóa sau 30 ngày"
  - → 30 ngày sau, file `report.pdf` bị xóa vĩnh viễn.
- ❌ Sau khi **bật versioning** :
  - Khi bạn cập nhật `report.pdf`, thì:
    - bản cũ trở thành **noncurrent version**
    - bản mới là **current version**
  - Nếu bạn chỉ có `expiration`, thì **chỉ bản hiện tại mới bị xóa** , còn bản cũ vẫn còn.
  - 👉 Bạn cần **thêm `noncurrent expiration`** để xóa cả bản cũ sau x ngày.

# 2.Một trường đại học Ivy League đang hỗ trợ NASA xác định các địa điểm hạ cánh tiềm năng cho tàu thăm dò không người lái. Họ sử dụng kiến trúc ứng dụng dựa trên **HPC** . Hỏi ứng dụng này nên triển khai EC2 theo kiểu topology nào?

---

## ✅ Đáp án đúng:

**The Amazon EC2 instances should be deployed in a _cluster placement group_ so that the underlying workload can benefit from low network latency and high network throughput.**

---

## 🔍 Giải thích chi tiết:

### 1. 🔬 **Hiểu yêu cầu của bài toán HPC:**

- **High Performance Computing (HPC)** là các ứng dụng tính toán hiệu năng cao, thường xử lý khối lượng lớn dữ liệu và yêu cầu:
  - **Truyền dữ liệu nhanh giữa các node**
  - **Độ trễ thấp**
  - **Băng thông mạng cao**
  - **Giao tiếp node-to-node thường xuyên**
- Ví dụ trong câu hỏi là một bài toán **khoa học không gian** , sử dụng tính toán mạnh để phân tích dữ liệu và mô phỏng, rất điển hình cho workload HPC.

---

### 2. 🧠 **Cluster Placement Group phù hợp nhất cho HPC vì:**

- **Cluster Placement Group** đặt tất cả các instance trong một nhóm **gần nhau về vật lý** bên trong **một Availability Zone (AZ)** .
- Điều này cho phép:
  - **Độ trễ mạng thấp**
  - **Tốc độ truyền dữ liệu giữa các EC2 cao**
  - Phù hợp với ứng dụng **tightly-coupled** , nơi các máy phải thường xuyên trao đổi dữ liệu.

> 📌 **HPC workloads luôn được khuyến nghị triển khai trong Cluster Placement Group** theo tài liệu chính thức của AWS.

---

## ❌ Giải thích các lựa chọn sai:

### 3. 🚫 **Partition Placement Group** :

- Dùng để tách nhóm EC2 theo **partition logic riêng biệt** , mỗi partition không dùng chung phần cứng.
  partition có thể ở các az khác nhau,**Tối đa** : 7 partition mỗi AZ.
- Tốt cho hệ thống phân tán lớn như **Hadoop, Cassandra, Kafka** .
- **Không tập trung các máy gần nhau** → **không đảm bảo độ trễ thấp** → **Không phù hợp cho HPC** .

---

### 4. 🚫 **Spread Placement Group** :

- Mỗi EC2 được đặt trên **racks khác nhau** , **cách ly vật lý** → giảm nguy cơ **các lỗi đồng thời** (correlated failures).
  , SPG có thể ở các az khác nhau,You can have a maximum of seven running instances per Availability Zone per group. (nghĩa là 7 instance trong 1 group ở 1 az )
- Phù hợp cho workload **yêu cầu độ sẵn sàng cao (HA)** , nhưng không yêu cầu truyền dữ liệu nhanh giữa máy.
- **Không tối ưu mạng giữa các máy** → **Không phù hợp HPC**

---

### 5. 🚫 **Auto Scaling Group** :

- Dùng để tự động **tăng/giảm số lượng EC2** theo tải.
- Tốt cho các ứng dụng **web / backend / microservices** , nơi cần **mở rộng linh hoạt** .
- Nhưng HPC thường **cố định số lượng node** , và yêu cầu **hiệu năng mạng cao** chứ không phải chỉ co giãn → **Không phù hợp HPC**

## 🧩 **1. Partition Placement Group (PPG)**

### ✅ Sự thật:

- **Tối đa 7 partition / AZ** .
- **Mỗi partition** có thể chứa **nhiều EC2 instance** (không giới hạn cụ thể).
- Các EC2 trong **cùng một partition** có thể **dùng chung phần cứng** .
- **Các partition khác nhau** thì **không dùng chung phần cứng** → tách biệt để tránh "correlated failure".

### 📌 Tóm lại:

| Thông số           | Giá trị                                 |
| ------------------ | --------------------------------------- |
| Số partition / AZ  | Tối đa 7                                |
| Số EC2 / partition | Gần như**không giới hạn**               |
| Số EC2 / AZ        | Tùy số EC2 bạn đặt trong từng partition |
| AZ khác nhau?      | ✅ Có thể triển khai trên nhiều AZ      |

---

## 🧩 **2. Spread Placement Group (SPG)**

### ✅ Sự thật:

- **Mỗi EC2 instance** được đặt trên **1 rack riêng biệt** .
- **Tối đa 7 EC2 / AZ / mỗi Spread Placement Group** (trừ khi xin tăng quota).
- **Một SPG có thể trải rộng nhiều AZ** , và mỗi AZ được **tối đa 7 EC2** .
- **Tổng cộng mỗi SPG có thể có: số AZ × 7 EC2 instance** (mặc định).

### 📌 Tóm lại:

| Thông số                            | Giá trị                               |
| ----------------------------------- | ------------------------------------- |
| Số EC2 / AZ / SPG                   | **Tối đa 7**(mỗi cái trên rack riêng) |
| Tổng EC2 / SPG                      | AZ × 7                                |
| EC2 dùng chung rack?                | ❌ Không                              |
| Triển khai đa AZ?                   | ✅ Có thể                             |
| Bạn có thể tạo bao nhiêu SPG tùy ý. |                                       |

---

### 🧠 **So sánh : Cluster vs Partition vs Spread Placement Group**

| **Tiêu chí**                                    | **Cluster Placement Group**                                                                         | **Partition Placement Group**                                                                      | **Spread Placement Group**                                                                                  |
| ----------------------------------------------- | --------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------- |
| 💡**Khái niệm cốt lõi**                         | Nhóm các EC2 gần nhau về vật lý để đạt**hiệu suất mạng tối đa**                                     | Nhóm EC2 thành**các partition độc lập phần cứng **nhằm**giảm rủi ro lan truyền lỗi phần cứng**     | Mỗi EC2 nằm**trên một rack riêng biệt** , tối đa hóa khả năng **cách ly lỗi phần cứng**                     |
| 📌**Mô hình triển khai phần cứng**              | Các EC2 nằm**rất gần nhau**(có thể cùng rack hoặc lân cận trong AZ)                                 | Mỗi partition dùng phần cứng riêng; các partition**không chia sẻ thiết bị**                        | Mỗi EC2 nằm trên**một rack khác nhau**→ mỗi rack có nguồn điện, mạng riêng biệt                             |
| ⚙️**Kiến trúc phù hợp**                         | **Tightly-coupled systems**– hệ thống cần truyền thông liên tục, tốc độ cao (HPC, AI, ML, MPI, CFD) | **Distributed systems**– hệ thống phân tán, cần song song hóa, ví dụ Hadoop, Cassandra, Kafka      | **Critical systems**– hệ thống lõi không được phép cùng hỏng, như DB, quorum-based clusters, control planes |
| 🔌**Hiệu suất mạng**                            | ✅**Cao nhất**– bandwidth lớn, latency thấp                                                         | ❌ Không đảm bảo cao vì có thể trải qua nhiều AZ                                                   | ❌ Không đảm bảo cao, vì các EC2 phân tán vật lý                                                            |
| 🔒**Tách biệt lỗi phần cứng (fault isolation)** | ❌ Không (các EC2 có thể cùng rack)                                                                 | ✅ Theo nhóm (partition cách ly nhau, nhưng cùng partition vẫn có thể bị lỗi chung)                | ✅ Tối đa – mỗi EC2 nằm rack khác, gần như lỗi phần cứng không bao giờ ảnh hưởng đồng thời 2 instance       |
| 🧱**Khả năng chịu lỗi (resilience)**            | Thấp – nếu rack lỗi có thể ảnh hưởng cả nhóm                                                        | Trung bình – lỗi chỉ ảnh hưởng 1 partition                                                         | Cao – lỗi chỉ ảnh hưởng 1 EC2, các EC2 còn lại vẫn hoạt động                                                |
| 📚**Khả năng mở rộng (scalability)**            | Hạn chế – càng nhiều EC2 càng khó giữ gần nhau                                                      | Rất tốt – có thể mở rộng dễ dàng bằng thêm partition hoặc AZ khác                                  | Kém – bị giới hạn 7 EC2 / AZ / SPG mặc định                                                                 |
| 🔁**Auto Scaling phù hợp không?**               | Không phù hợp lắm vì phụ thuộc vào khả năng gói cụm                                                 | ✅ Phù hợp với workload phân tán mở rộng tự nhiên                                                  | ❌ Không khuyến khích – dễ vượt giới hạn instance                                                           |
| 🌐**Multi-AZ hỗ trợ?**                          | ❌ Không – chỉ được trong**1 AZ duy nhất**                                                          | ✅ Có thể trải rộng**nhiều AZ**                                                                    | ✅ Có thể trải rộng**nhiều AZ**                                                                             |
| 🧮**Số lượng phần tử / giới hạn mặc định**      | Không giới hạn cụ thể, nhưng khó đạt hiệu quả khi nhiều EC2                                         | Tối đa 7 partition / AZ, mỗi partition chứa**nhiều EC2**                                           | Tối đa 7 EC2 / AZ / SPG (mặc định)                                                                          |
| 🧭**Cách điều phối phần cứng của AWS**          | Gán EC2 vào vùng phần cứng cực gần (low-latency fabric)                                             | Mỗi partition được đặt trên cụm phần cứng riêng, không dùng chung network/power với partition khác | Mỗi EC2 ép buộc vào rack vật lý riêng – mỗi rack có power/network riêng                                     |

Giới hạn mặc định trên mỗi Region 100 cho cả 3 loại

### 🧪 **Khi nào dùng loại nào?**

| Tình huống                                                                         | Loại nên dùng       |
| ---------------------------------------------------------------------------------- | ------------------- |
| Cần tính toán hiệu năng cao (AI/ML/HPC) – giao tiếp nhanh giữa EC2                 | Cluster Placement   |
| Xử lý Big Data phân tán, nhiều node, tính song song cao (Kafka, Hadoop, Cassandra) | Partition Placement |
| Hệ thống quan trọng, không được lỗi cùng lúc (DB, master node, quorum, etcd...)    | Spread Placement    |

# 3.**Cost of test file storage on**

Amazon S3 Standard < Cost of test file storage on Amazon EFS < Cost of test file storage on Amazon EBS\*\*

With Amazon EBS Elastic Volumes, you pay only for the resources that you use. The Amazon EFS Standard Storage pricing is $0.30 per GB per month. Therefore the cost for storing the test file on EFS is $0.30 for the month.

For Amazon EBS General Purpose SSD (gp2) volumes, the charges are $0.10 per GB-month of provisioned storage. Therefore, for a provisioned storage of 100GB for this use-case, the monthly cost on EBS is $0.10\*100 = $10. This cost is irrespective of how much storage is actually consumed by the test file.

For S3 Standard storage, the pricing is $0.023 per GB per month. Therefore, the monthly storage cost on S3 for the test file is $0.023.

# 4.**Kịch bản:** Công ty bán lẻ có trang web động chạy trên máy chủ tại trung tâm dữ liệu ở Mỹ. Sắp ra mắt ở Châu Á, cần **giảm độ trễ** cho người dùng tại đây **ngay lập tức** , trong khi **backend (máy chủ xử lý logic) VẪN PHẢI ở Mỹ** .

**Giải pháp phù hợp nhất:** **Sử dụng Amazon CloudFront với Custom Origin trỏ đến máy chủ On-Premises của bạn.**

- **Giải thích:**
  - **Amazon CloudFront** là dịch vụ Mạng phân phối nội dung (CDN) toàn cầu của AWS. Nó có mạng lưới các điểm biên (edge locations) và bộ nhớ đệm khu vực (regional edge caches) đặt rải rác khắp thế giới (gần người dùng cuối).
  - **Custom Origin:** CloudFront có thể lấy nội dung gốc từ nhiều nguồn (origin). Ngoài S3 hoặc EC2, nó có thể lấy nội dung từ bất kỳ máy chủ HTTP nào có thể truy cập được qua Internet, bao gồm cả máy chủ On-Premises của bạn. Máy chủ On-Premises trong trường hợp này chính là "Custom Origin" của CloudFront.
  - **Tại sao giải quyết vấn đề:** Khi người dùng ở Châu Á truy cập trang web, yêu cầu của họ sẽ được chuyển đến điểm biên CloudFront gần nhất. CloudFront sẽ lưu bản sao nội dung (đặc biệt là nội dung tĩnh hoặc nội dung động có thể cache được) tại điểm biên này. Lần truy cập tiếp theo hoặc bởi người dùng khác trong cùng khu vực, CloudFront sẽ phục vụ nội dung trực tiếp từ điểm biên gần đó. Điều này giảm đáng kể quãng đường vật lý mà dữ liệu phải di chuyển, từ đó **giảm độ trễ và tối ưu thời gian tải trang** cho người dùng ở Châu Á, **mà không cần di chuyển backend** (máy chủ xử lý chính ở Mỹ).

**Tại sao các lựa chọn khác không phù hợp:**

- **CloudFront Custom Origin trỏ đến Route 53 DNS record:** **Sai cấu hình** . CloudFront Origin cần trỏ đến một endpoint chứa nội dung (như máy chủ HTTP hoặc S3 bucket), không phải bản ghi DNS trong Route 53 (Route 53 chỉ giải quyết tên miền thành địa chỉ IP).
- **Di chuyển website sang S3 + S3 CRR:** **Sai** . Trang web là **động** . S3 chỉ phù hợp cho **website tĩnh** . S3 không chạy code xử lý phía máy chủ (server-side scripting). S3 CRR (sao chép dữ liệu giữa các bucket S3) không liên quan đến việc chạy website động hoặc giảm độ trễ cho xử lý backend.
- **Route 53 Geo-proximity routing trỏ đến máy chủ On-Premises:** **Sai** . Geo-proximity routing của Route 53 chỉ giúp định tuyến người dùng đến endpoint _gần nhất_ bạn đã định nghĩa. Tuy nhiên, vì máy chủ On-Premises duy nhất vẫn ở Mỹ, người dùng ở Châu Á vẫn sẽ được định tuyến trực tiếp đến máy chủ _xa_ đó. Nó không giảm quãng đường thực tế và không giải quyết được độ trễ do khoảng cách địa lý đối với các tương tác với backend ở Mỹ.

**CloudFront** mang nội dung (cache) lại **gần người dùng** ở Châu Á -> giảm quãng đường -> **giảm độ trễ** -> tải nhanh hơn, **backend vẫn ở chỗ cũ** .
